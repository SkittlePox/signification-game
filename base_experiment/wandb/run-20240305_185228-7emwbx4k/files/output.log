[2024-03-05 18:53:01,222][jax._src.profiler][INFO] - Loading trace.json.gz and removing its metadata...
[2024-03-05 18:53:02,442][jax._src.profiler][INFO] - Writing perfetto_trace.json.gz...
Open URL in browser: https://ui.perfetto.dev/#!/?url=http://127.0.0.1:9001/perfetto_trace.json.gz
127.0.0.1 - - [05/Mar/2024 18:53:16] code 404, message File not found
127.0.0.1 - - [05/Mar/2024 18:53:16] "POST /status HTTP/1.1" 404 -
127.0.0.1 - - [05/Mar/2024 18:53:16] "GET /perfetto_trace.json.gz HTTP/1.1" 200 -
Error executing job with overrides: []
jax.errors.SimplifiedTraceback: For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
The above exception was the direct cause of the following exception:
Traceback (most recent call last):
  File "/Users/benjamin/code/signification-game/base_experiment/ippo_ff.py", line 557, in main
    out = train(rng)
  File "/Users/benjamin/code/signification-game/base_experiment/ippo_ff.py", line 515, in train
    runner_state, traj_batch = jax.lax.scan( # Perform the update step for a specified number of updates and update the runner state
jaxlib.xla_extension.XlaRuntimeError: INTERNAL: Generated function failed: CpuCallback error: TypeError: mean requires ndarray or scalar arguments, got <class 'tuple'> at position 0.
At:
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/numpy/util.py(335): check_arraylike
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/numpy/reductions.py(327): _mean
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/linear_util.py(200): call_wrapped
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py(2313): trace_to_subjaxpr_dynamic
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/interpreters/partial_eval.py(2290): trace_to_jaxpr_dynamic
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/profiler.py(336): wrapper
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/pjit.py(936): _create_pjit_jaxpr
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/linear_util.py(349): memoized_fun
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/pjit.py(996): _pjit_jaxpr
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/pjit.py(493): common_infer_params
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/api.py(317): infer_params
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/pjit.py(163): _python_pjit_helper
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/pjit.py(257): cache_miss
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/traceback_util.py(227): reraise_with_filtered_traceback
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/numpy/reductions.py(319): mean
  /Users/benjamin/code/signification-game/base_experiment/ippo_ff.py(500): <dictcomp>
  /Users/benjamin/code/signification-game/base_experiment/ippo_ff.py(500): callback
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/callback.py(509): _flat_callback
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/callback.py(378): io_callback_impl
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/callback.py(431): _callback
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/interpreters/mlir.py(2367): _wrapped_callback
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/interpreters/pxla.py(1151): __call__
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/profiler.py(336): wrapper
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/pjit.py(1185): _pjit_call_impl_python
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/pjit.py(1229): call_impl_cache_miss
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/pjit.py(1245): _pjit_call_impl
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/core.py(935): process_primitive
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/core.py(447): bind_with_trace
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/core.py(2740): bind
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/pjit.py(168): _python_pjit_helper
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/pjit.py(257): cache_miss
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/traceback_util.py(179): reraise_with_filtered_traceback
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/dispatch.py(87): apply_primitive
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/core.py(935): process_primitive
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/core.py(447): bind_with_trace
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/core.py(2740): bind
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/lax/control_flow/loops.py(1130): scan_bind
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/lax/control_flow/loops.py(273): scan
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/jax/_src/traceback_util.py(179): reraise_with_filtered_traceback
  /Users/benjamin/code/signification-game/base_experiment/ippo_ff.py(515): train
  /Users/benjamin/code/signification-game/base_experiment/ippo_ff.py(557): main
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/hydra/core/utils.py(186): run_job
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/hydra/_internal/hydra.py(119): run
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/hydra/_internal/utils.py(458): <lambda>
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/hydra/_internal/utils.py(220): run_and_report
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/hydra/_internal/utils.py(457): _run_app
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/hydra/_internal/utils.py(394): _run_hydra
  /Users/benjamin/miniforge3/envs/siggame/lib/python3.9/site-packages/hydra/main.py(94): decorated_main
  /Users/benjamin/code/signification-game/base_experiment/ippo_ff.py(562): <module>
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.