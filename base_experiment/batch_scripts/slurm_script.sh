#!/bin/bash

#SBATCH -J siggame
#SBATCH -N 1
#SBATCH -c 4
#SBATCH --ntasks=1
#SBATCH --ntasks-per-node=1
#SBATCH --time=12:00:00
#SBATCH --mem=12GB
#SBATCH --partition=gpu
#SBATCH --gres=gpu:1
#SBATCH -C quadrortx
#SBATCH -o job_outputs/siggame_job_%j.o
#SBATCH -e job_outputs/siggame_job_%j.e
#SBATCH --mail-type=END
#SBATCH --mail-user=benjamin_spiegel@brown.edu

echo $LD_LIBRARY_PATH
unset LD_LIBRARY_PATH
echo $LD_LIBRARY_PATH

# export JAX_DEBUG_NANS=True

source /oscar/home/bspiegel/envs/jax.venv/bin/activate
cd /oscar/home/bspiegel/signification-game/base_experiment/

### Basic Experiments (These take just over 3 hrs approx)
# python3 -u ippo_ff.py WANDB_NOTES="Codename-R1" ENV_KWARGS.sigmoid_offset=800 ENV_KWARGS.sigmoid_stretch=0.005 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 1e-5 at 2000"
# python3 -u ippo_ff.py WANDB_NOTES="Codename-R4 - Trying 20 agents" ENV_KWARGS.sigmoid_offset=700 ENV_KWARGS.sigmoid_stretch=0.006 SPEAKER_TRAIN_SCHEDULE="off then on at 350" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 350 anneal to 1e-5 at 2000"
# python3 -u ippo_ff.py WANDB_NOTES="Codename-R3" ENV_KWARGS.sigmoid_offset=700 ENV_KWARGS.sigmoid_stretch=0.006 SPEAKER_TRAIN_SCHEDULE="off then on at 350" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 350 anneal to 1e-5 at 2000"
# python3 -u ippo_ff.py WANDB_NOTES="Codename-R6 Rerun lr diff - quadrortx - Trying 10 agents with a reintroduction of env images" ENV_KWARGS.channel_ratio_fn="sigmoid-custom-cutoff-3500" ENV_KWARGS.sigmoid_offset=700 ENV_KWARGS.sigmoid_stretch=0.006 SPEAKER_TRAIN_SCHEDULE="off then on at 350" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 350 anneal to 2e-5 at 2000"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R1c - L2 Reg Speakers - Trying 5 agents and looking for results with new iconicity probe" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=600 ENV_KWARGS.sigmoid_stretch=0.005 SPEAKER_TRAIN_SCHEDULE="off then on at 324" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 324 anneal to 2e-5 at 1500" L2_REG_COEF_LISTENER=0.0
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R3 - Speaker LR Boost and smoother channel ratio fn" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=800 ENV_KWARGS.sigmoid_stretch=0.003 SPEAKER_TRAIN_SCHEDULE="off then on at 324" LISTENER_LR_SCHEDULE="1e-4 jump to 2e-6 at 324" SPEAKER_LR_SCHEDULE="2e-4"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R5f - More listeners - tighter channel ratio fn - negative whitesum penalty - higher speaker lr" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=690 ENV_KWARGS.sigmoid_stretch=0.005 ENV_KWARGS.speaker_whitesum_penalty_coef=-0.05 SPEAKER_TRAIN_SCHEDULE="off then on at 250" LISTENER_LR_SCHEDULE="1e-4 jump to 3e-5 at 250" SPEAKER_LR_SCHEDULE="1e-3"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R6b - Tiny whitesum penalty - higher speaker lr" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=710 ENV_KWARGS.sigmoid_stretch=0.003 ENV_KWARGS.speaker_whitesum_penalty_coef=0.01 SPEAKER_TRAIN_SCHEDULE="off then on at 250" LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250" SPEAKER_LR_SCHEDULE="6e-4"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R7b - Annealing again - negative tiny whitesum penalty" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=710 ENV_KWARGS.sigmoid_stretch=0.003 ENV_KWARGS.speaker_whitesum_penalty_coef=-0.02 SPEAKER_TRAIN_SCHEDULE="off then on at 250" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 250 anneal to 1e-5 at 1500" SPEAKER_LR_SCHEDULE="2e-4"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R8b - Tweaking 1901" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=760 ENV_KWARGS.sigmoid_stretch=0.003 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="2e-4" L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R9d - Running with 1926 - Even Tighter channel ratio fn - Tiny whitesum penalty" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=0.01 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R10d - negative tiny whitesum penalty" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=-0.01 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R11b - Auto-centering and no penalties - 3 splines" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.center_listener_obs=True ENV_KWARGS.speaker_action_dim=18 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R12d - Negative Smaller Curve penalty" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=-0.05 ENV_KWARGS.center_listener_obs=False ENV_KWARGS.speaker_action_dim=12 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 WANDB_MODE="online"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1a-R3 - Asymmetric no penalties quicker speaker onset - Zero listener rewards" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=400 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.sigmoid_height=0.6 ENV_KWARGS.speaker_assignment_method="arange" ENV_KWARGS.symmetric_rewards=False ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 WANDB_MODE="online"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-R4b - Basic Experiment - No penalties" ENV_KWARGS.channel_ratio_fn="0.4 at 300" ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 UPDATE_EPOCHS=2000 PICKLE_FINAL_AGENTS=True WANDB_MODE="online"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-R4f - Log test Basic Experiment - No penalties - 6 referents" ENV_KWARGS.channel_ratio_fn="0.4 at 300" ENV_KWARGS.speaker_referent_span_fn=6 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 1e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 UPDATE_EPOCHS=3000 PICKLE_FINAL_AGENTS=True WANDB_MODE="online"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-R4g - Just listeners" ENV_KWARGS.channel_ratio_fn="0.4 at 300" ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 1e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 UPDATE_EPOCHS=300 PICKLE_FINAL_AGENTS=True WANDB_MODE="online"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1b-R1- Testrun - Asymmetric then symmetric" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=400 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.sigmoid_height=0.6 ENV_KWARGS.speaker_assignment_method=arange ENV_KWARGS.reward_parity_fn="1.0 at 1000" ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 WANDB_MODE=online
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1b-R5a - No Squeeze ManipCoop 1000 - negative curvature penalty" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=-0.05 ENV_KWARGS.reward_parity_fn="1.0 at 1000" SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 WANDB_MODE=online
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1b-R5b - Squeeze - ManipCoop 1000 - negative curvature penalty" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=360 ENV_KWARGS.sigmoid_stretch=0.009 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=-0.05 ENV_KWARGS.reward_parity_fn="1.0 at 1000" SPEAKER_TRAIN_SCHEDULE="off then on at 200" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 200 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 WANDB_MODE=online
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1b-R7c - Squeeze - ManipCoop 600 - larger negative whitesum penalty + autocenter" ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=360 ENV_KWARGS.sigmoid_stretch=0.009 ENV_KWARGS.center_listener_obs=True ENV_KWARGS.speaker_whitesum_penalty_coef=-0.02 ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.reward_parity_fn="1.0 at 600" SPEAKER_TRAIN_SCHEDULE="off then on at 200" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 200 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 WANDB_MODE=online

#### For testing listener train state loading. Doing this with MNIST
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R8b - mnist - listeners epoch 100 with 5000 datapoints" +dataset=mnist ENV_NUM_DATAPOINTS=5000 ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn="0.0" LISTENER_N_SAMPLES=50 ENV_KWARGS.speaker_n_samples=50 SPEAKER_N_SEARCH=5 ENV_KWARGS.reward_parity_fn=coop SPEAKER_TRAIN_SCHEDULE="off" UPDATE_EPOCHS=100 WANDB_MODE=online PICKLE_FINAL_AGENTS=True
# Load listeners, manip setting. Train speakers and listeners. Should see perfect icons.
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R8c - Test with pretrained mnist listeners" +dataset=mnist PRETRAINED_LISTENERS="agents-mnist-100e-5000dp-13fd" ENV_NUM_DATAPOINTS=5000 ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn="0.2" ENV_KWARGS.reward_parity_fn=manip SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=500 WANDB_MODE=online


#### ToM Experiments (These can take a long time, probably 3-4x as long per epoch.)
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R3 - Cifar-10 basic gut listener test" ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn="all_env" LISTENER_N_SAMPLES=50 ENV_KWARGS.speaker_n_samples=50 SPEAKER_N_SEARCH=5 ENV_KWARGS.reward_parity_fn=coop SPEAKER_TRAIN_SCHEDULE="off" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 25 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 UPDATE_EPOCHS=1500 WANDB_MODE=online
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R4 - 1 Gut speaker" +dataset=cifar10 ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn="all_env" LISTENER_N_SAMPLES=50 ENV_KWARGS.speaker_n_samples=50 SPEAKER_N_SEARCH=5 ENV_KWARGS.reward_parity_fn=coop SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4" SPEAKER_LR_SCHEDULE=2e-4 WANDB_MODE=online
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R6 - 1 Gut speaker manip 3500 epochs spline weight" +dataset=cifar10 ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn="0.2 at 300" LISTENER_N_SAMPLES=50 ENV_KWARGS.speaker_n_samples=50 SPEAKER_N_SEARCH=5 ENV_KWARGS.reward_parity_fn=coop SPEAKER_TRAIN_SCHEDULE="off then on at 300" UPDATE_EPOCHS=3500 WANDB_MODE=online


#### For collecting listeners to run ToM experiments on
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R10b - cifar10 just listeners 10000" +dataset=cifar10 ENV_KWARGS.channel_ratio_fn="0.0" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 2000 anneal to 1e-5 at 3000" SPEAKER_TRAIN_SCHEDULE="off" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=10000 WANDB_MODE=online PICKLE_FINAL_AGENTS=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R11a - cifar10 1 gut speaker and listeners" +dataset=cifar10 ENV_KWARGS.channel_ratio_fn="0.2" LISTENER_LR_SCHEDULE="1e-6 anneal to 1e-5 at 1000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10-2000e-5000dp-2d21" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R11b - cifar10 2 gut speaker and listeners" +dataset=cifar10 ENV_KWARGS.channel_ratio_fn="0.2" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 2000 anneal to 1e-5 at 3000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10-peach-spaceship-2253-2000e-5000dp-0fea" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R14 - cifar10b just listeners 5000" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0" LISTENER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=True

#### For a Speaker Baseline. 0.5 channel ratio, random speaker assignment.
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R12 - cifar10b speaker baseline 0.5 channel ratio" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=gut LISTENER_LR_SCHEDULE="1e-6 anneal to 1e-5 at 2000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False
## This one has a custom sigmoid fn.
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R12 - cifar10b speaker baseline sigmoid ch" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=300 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=gut LISTENER_LR_SCHEDULE="1e-6 anneal to 1e-5 at 2000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False

#### For tom agents. 0.5 channel ratio, random speaker assignment.
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 listener samples 6" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=tom LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=5 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE="1e-6 anneal to 1e-5 at 2000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False
## These have custom sigmoid fn
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 listener samples 6 sigmoid ch" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=300 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=tom LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=5 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE="1e-6 anneal to 1e-5 at 2000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 listener samples 6 sigmoid ch stretched" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=410 ENV_KWARGS.sigmoid_stretch=0.005 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=tom LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=5 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE="1e-6 anneal to 1e-5 at 2000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False
python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 listener samples 6 0.3 to sigmoid" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=1900 ENV_KWARGS.sigmoid_stretch=0.005 ENV_KWARGS.sigmoid_height=0.7 ENV_KWARGS.sigmoid_stilt=0.3 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=tom LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=5 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE="1e-6 anneal to 1e-5 at 2000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False

# for cifar10: "agents-cifar10-peach-spaceship-2253-2000e-5000dp-0fea"
