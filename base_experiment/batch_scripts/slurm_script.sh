#!/bin/bash

#SBATCH -J siggame
#SBATCH -N 1
#SBATCH -c 4
#SBATCH --ntasks=1
#SBATCH --ntasks-per-node=1
#SBATCH --time=16:00:00
#SBATCH --mem=12GB
#SBATCH --partition=gpu
#SBATCH --gres=gpu:1
#SBATCH -C quadrortx
#SBATCH -o job_outputs/siggame_job_%j.o
#SBATCH -e job_outputs/siggame_job_%j.e
#SBATCH --mail-type=END
#SBATCH --mail-user=benjamin_spiegel@brown.edu

echo $LD_LIBRARY_PATH
unset LD_LIBRARY_PATH
echo $LD_LIBRARY_PATH

# export JAX_DEBUG_NANS=True

source /oscar/home/bspiegel/envs/jax.venv/bin/activate
cd /oscar/home/bspiegel/signification-game/base_experiment/

### Basic Experiments (These take just over 3 hrs approx)
# python3 -u ippo_ff.py WANDB_NOTES="Codename-R1" ENV_KWARGS.sigmoid_offset=800 ENV_KWARGS.sigmoid_stretch=0.005 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 1e-5 at 2000"
# python3 -u ippo_ff.py WANDB_NOTES="Codename-R4 - Trying 20 agents" ENV_KWARGS.sigmoid_offset=700 ENV_KWARGS.sigmoid_stretch=0.006 SPEAKER_TRAIN_SCHEDULE="off then on at 350" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 350 anneal to 1e-5 at 2000"
# python3 -u ippo_ff.py WANDB_NOTES="Codename-R3" ENV_KWARGS.sigmoid_offset=700 ENV_KWARGS.sigmoid_stretch=0.006 SPEAKER_TRAIN_SCHEDULE="off then on at 350" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 350 anneal to 1e-5 at 2000"
# python3 -u ippo_ff.py WANDB_NOTES="Codename-R6 Rerun lr diff - quadrortx - Trying 10 agents with a reintroduction of env images" ENV_KWARGS.channel_ratio_fn="sigmoid-custom-cutoff-3500" ENV_KWARGS.sigmoid_offset=700 ENV_KWARGS.sigmoid_stretch=0.006 SPEAKER_TRAIN_SCHEDULE="off then on at 350" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 350 anneal to 2e-5 at 2000"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R1c - L2 Reg Speakers - Trying 5 agents and looking for results with new iconicity probe" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=600 ENV_KWARGS.sigmoid_stretch=0.005 SPEAKER_TRAIN_SCHEDULE="off then on at 324" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 324 anneal to 2e-5 at 1500" L2_REG_COEF_LISTENER=0.0
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R3 - Speaker LR Boost and smoother channel ratio fn" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=800 ENV_KWARGS.sigmoid_stretch=0.003 SPEAKER_TRAIN_SCHEDULE="off then on at 324" LISTENER_LR_SCHEDULE="1e-4 jump to 2e-6 at 324" SPEAKER_LR_SCHEDULE="2e-4"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R5f - More listeners - tighter channel ratio fn - negative whitesum penalty - higher speaker lr" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=690 ENV_KWARGS.sigmoid_stretch=0.005 ENV_KWARGS.speaker_whitesum_penalty_coef=-0.05 SPEAKER_TRAIN_SCHEDULE="off then on at 250" LISTENER_LR_SCHEDULE="1e-4 jump to 3e-5 at 250" SPEAKER_LR_SCHEDULE="1e-3"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R6b - Tiny whitesum penalty - higher speaker lr" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=710 ENV_KWARGS.sigmoid_stretch=0.003 ENV_KWARGS.speaker_whitesum_penalty_coef=0.01 SPEAKER_TRAIN_SCHEDULE="off then on at 250" LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250" SPEAKER_LR_SCHEDULE="6e-4"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R7b - Annealing again - negative tiny whitesum penalty" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=710 ENV_KWARGS.sigmoid_stretch=0.003 ENV_KWARGS.speaker_whitesum_penalty_coef=-0.02 SPEAKER_TRAIN_SCHEDULE="off then on at 250" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 250 anneal to 1e-5 at 1500" SPEAKER_LR_SCHEDULE="2e-4"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R8b - Tweaking 1901" ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=760 ENV_KWARGS.sigmoid_stretch=0.003 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="2e-4" L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R9d - Running with 1926 - Even Tighter channel ratio fn - Tiny whitesum penalty" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=0.01 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R10d - negative tiny whitesum penalty" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=-0.01 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R11b - Auto-centering and no penalties - 3 splines" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.center_listener_obs=True ENV_KWARGS.speaker_action_dim=18 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R12d - Negative Smaller Curve penalty" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=-0.05 ENV_KWARGS.center_listener_obs=False ENV_KWARGS.speaker_action_dim=12 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 WANDB_MODE="online"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1a-R3 - Asymmetric no penalties quicker speaker onset - Zero listener rewards" +dataset=mnist ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=400 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.sigmoid_height=0.6 ENV_KWARGS.speaker_assignment_method="arange" ENV_KWARGS.reward_parity_fn=manip ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 WANDB_MODE="online" JAX_RANDOM_SEED=51
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-R4b - Basic Experiment - No penalties" ENV_KWARGS.channel_ratio_fn="0.4 at 300" ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 UPDATE_EPOCHS=2000 PICKLE_FINAL_AGENTS=True WANDB_MODE="online"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-R4f - Log test Basic Experiment - No penalties - 6 referents" ENV_KWARGS.channel_ratio_fn="0.4 at 300" ENV_KWARGS.speaker_referent_span_fn=6 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 1e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 UPDATE_EPOCHS=3000 PICKLE_FINAL_AGENTS=True WANDB_MODE="online"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-R4g - Just listeners" ENV_KWARGS.channel_ratio_fn="0.4 at 300" ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 1e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 UPDATE_EPOCHS=300 PICKLE_FINAL_AGENTS=True WANDB_MODE="online"
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1b-R1- Testrun - Asymmetric then symmetric" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=400 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.sigmoid_height=0.6 ENV_KWARGS.speaker_assignment_method=arange ENV_KWARGS.reward_parity_fn="1.0 at 1000" ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 WANDB_MODE=online
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1b-R5a - No Squeeze ManipCoop 1000 - negative curvature penalty" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=-0.05 ENV_KWARGS.reward_parity_fn="1.0 at 1000" SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 WANDB_MODE=online
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1b-R5b - Squeeze - ManipCoop 1000 - negative curvature penalty" ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=360 ENV_KWARGS.sigmoid_stretch=0.009 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=-0.05 ENV_KWARGS.reward_parity_fn="1.0 at 1000" SPEAKER_TRAIN_SCHEDULE="off then on at 200" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 200 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 WANDB_MODE=online
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1b-R7c - Squeeze - ManipCoop 600 - larger negative whitesum penalty + autocenter" ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=360 ENV_KWARGS.sigmoid_stretch=0.009 ENV_KWARGS.center_listener_obs=True ENV_KWARGS.speaker_whitesum_penalty_coef=-0.02 ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.reward_parity_fn="1.0 at 600" SPEAKER_TRAIN_SCHEDULE="off then on at 200" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 200 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 WANDB_MODE=online


#### Re-running basic experiments from Part 1
# Rerun of 1950
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1a-R3 - Asymmetric no penalties quicker speaker onset - Zero listener rewards" +dataset=mnist +num_agents=five ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=400 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.sigmoid_height=0.6 ENV_KWARGS.speaker_assignment_method="arange" ENV_KWARGS.reward_parity_fn=manip ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=0.0 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 WANDB_MODE="online" JAX_RANDOM_SEED=$SLURM_ARRAY_TASK_ID
# Rerun of 1975
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1b-R7b - Squeeze - ManipCoop 600 - larger negative whitesum penalty" +dataset=mnist +num_agents=five ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=360 ENV_KWARGS.sigmoid_stretch=0.009 ENV_KWARGS.center_listener_obs=False ENV_KWARGS.speaker_whitesum_penalty_coef=-0.02 ENV_KWARGS.speaker_curve_penalty_coef=0.0 "ENV_KWARGS.reward_parity_fn=1.0 at 600" SPEAKER_TRAIN_SCHEDULE="off then on at 200" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 200 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 WANDB_MODE=online JAX_RANDOM_SEED=$SLURM_ARRAY_TASK_ID
# Rerun of 1973
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part1b-R6d - Squeeze - ManipCoop 700 - negative curvature penalty" +dataset=mnist +num_agents=five ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=360 ENV_KWARGS.sigmoid_stretch=0.009 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=-0.05 "ENV_KWARGS.reward_parity_fn=1.0 at 600" SPEAKER_TRAIN_SCHEDULE="off then on at 200" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 200 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 WANDB_MODE=online JAX_RANDOM_SEED=$SLURM_ARRAY_TASK_ID
# Rerun of 1934
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R10c - Improving 2930 - More annealing - negative tiny whitesum penalty" +dataset=mnist +num_agents=five ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=-0.01 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 2000" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 WANDB_MODE=online JAX_RANDOM_SEED=$SLURM_ARRAY_TASK_ID
# Rerun of 1945
# python3 -u ippo_ff.py WANDB_NOTES="Post-Hiatus-R12d - Negative Smaller Curve penalty" +dataset=mnist +num_agents=five ENV_KWARGS.channel_ratio_fn=sigmoid-custom ENV_KWARGS.sigmoid_offset=498 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_curve_penalty_coef=-0.05 ENV_KWARGS.center_listener_obs=False ENV_KWARGS.speaker_action_dim=12 SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 300 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 L2_REG_COEF_LISTENER=1e-5 L2_REG_COEF_SPEAKER=1e-5 WANDB_MODE=online JAX_RANDOM_SEED=$SLURM_ARRAY_TASK_ID


#### For testing listener train state loading. Doing this with MNIST
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R8b - mnist - listeners epoch 100 with 5000 datapoints" +dataset=mnist ENV_NUM_DATAPOINTS=5000 ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn="0.0" LISTENER_N_SAMPLES=50 ENV_KWARGS.speaker_n_samples=50 SPEAKER_N_SEARCH=5 ENV_KWARGS.reward_parity_fn=coop SPEAKER_TRAIN_SCHEDULE="off" UPDATE_EPOCHS=100 WANDB_MODE=online PICKLE_FINAL_AGENTS=True
# Load listeners, manip setting. Train speakers and listeners. Should see perfect icons.
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R8c - Test with pretrained mnist listeners" +dataset=mnist PRETRAINED_LISTENERS="agents-mnist-100e-5000dp-13fd" ENV_NUM_DATAPOINTS=5000 ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn="0.2" ENV_KWARGS.reward_parity_fn=manip SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=500 WANDB_MODE=online


#### ToM Experiments (These can take a long time, probably 3-4x as long per epoch.)
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R3 - Cifar-10 basic gut listener test" ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn="all_env" LISTENER_N_SAMPLES=50 ENV_KWARGS.speaker_n_samples=50 SPEAKER_N_SEARCH=5 ENV_KWARGS.reward_parity_fn=coop SPEAKER_TRAIN_SCHEDULE="off" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 25 anneal to 2e-5 at 1500" SPEAKER_LR_SCHEDULE=2e-4 UPDATE_EPOCHS=1500 WANDB_MODE=online
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R4 - 1 Gut speaker" +dataset=cifar10 ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn="all_env" LISTENER_N_SAMPLES=50 ENV_KWARGS.speaker_n_samples=50 SPEAKER_N_SEARCH=5 ENV_KWARGS.reward_parity_fn=coop SPEAKER_TRAIN_SCHEDULE="off then on at 300" LISTENER_LR_SCHEDULE="1e-4" SPEAKER_LR_SCHEDULE=2e-4 WANDB_MODE=online
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R6 - 1 Gut speaker manip 3500 epochs spline weight" +dataset=cifar10 ENV_KWARGS.agent_inferential_mode_fn=gut ENV_KWARGS.channel_ratio_fn="0.2 at 300" LISTENER_N_SAMPLES=50 ENV_KWARGS.speaker_n_samples=50 SPEAKER_N_SEARCH=5 ENV_KWARGS.reward_parity_fn=coop SPEAKER_TRAIN_SCHEDULE="off then on at 300" UPDATE_EPOCHS=3500 WANDB_MODE=online


#### For collecting listeners to run ToM experiments on
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R10b - cifar10 just listeners 10000" +dataset=cifar10 ENV_KWARGS.channel_ratio_fn="0.0" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 2000 anneal to 1e-5 at 3000" SPEAKER_TRAIN_SCHEDULE="off" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=10000 WANDB_MODE=online PICKLE_FINAL_AGENTS=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R11a - cifar10 1 gut speaker and listeners" +dataset=cifar10 ENV_KWARGS.channel_ratio_fn="0.2" LISTENER_LR_SCHEDULE="1e-6 anneal to 1e-5 at 1000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10-2000e-5000dp-2d21" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R11b - cifar10 2 gut speaker and listeners" +dataset=cifar10 ENV_KWARGS.channel_ratio_fn="0.2" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-6 at 2000 anneal to 1e-5 at 3000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10-peach-spaceship-2253-2000e-5000dp-0fea" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R14 - cifar10b just listeners 5000" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0" LISTENER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=True

#### For a Speaker Baseline. 0.5 channel ratio, random speaker assignment.
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R12 - cifar10b speaker baseline -0.05 curve penalty and 1e-3 speaker l2 reg" +dataset=cifar10b ENV_KWARGS.speaker_curve_penalty_coef=-0.05 ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=gut LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=1000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False
## This one has a custom sigmoid fn.
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R12 - cifar10b speaker baseline sigmoid ch" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="sigmoid-custom" ENV_KWARGS.sigmoid_offset=300 ENV_KWARGS.sigmoid_stretch=0.007 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=gut LISTENER_LR_SCHEDULE="1e-6 anneal to 1e-5 at 2000" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False

#### For tom agents. 0.5 channel ratio, random speaker assignment.
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 listener samples 6 ch 0.5" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=tom LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=10 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 half length epochs" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" NUM_STEPS=1024 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=tom LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=10 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=1000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 half length epochs 4 splines slower listeners" +dataset=cifar10b ENV_KWARGS.speaker_action_dim=28 ENV_KWARGS.channel_ratio_fn="0.5" NUM_STEPS=1024 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn=tom LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=10 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE="5e-6" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=1000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 no penalties com mode anneal" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0 jump to 1.0 at 300 anneal to 0.4 at 600" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=10 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
## These have 0.5 channel ratio, and penalties
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 curve penalty -0.05" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=-0.05 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0 jump to 0.0 at 300" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=10 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=1000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - compare 2345 - cifar10b tom agents pr 1.0 curve penalty -0.05 com mode anneal larger speaker l2 term" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=-0.05 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0 jump to 1.0 at 300 anneal to 0.4 at 600" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=10 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 whitesum penalty 0.05 com mode anneal" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_whitesum_penalty_coef=0.05 ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0 jump to 1.0 at 300 anneal to 0.4 at 600" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=10 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

#### Used for final experiment:
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b gut speaker baseline no penalties with larger speaker l2 norm term" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="0.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=1 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=False
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 no penalties speaker n search anneal with larger speaker l2 norm term" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="10 jump to 10 at 300 anneal to 1 at 750" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 curve penalty -5.0 speaker n search anneal with larger speaker l2 norm term" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=-5.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="10 jump to 10 at 300 anneal to 1 at 750" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - cifar10b tom agents pr 1.0 new whitesum penalty 0.5 speaker n search anneal with larger speaker l2 norm term" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.5 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="10 jump to 10 at 300 anneal to 1 at 750" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

# Below is P_R ablation for run 2353
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - ablate Pr - cifar10b tom agents pr 1.0 no penalties speaker n search anneal with larger speaker l2 norm term" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn=0.5 ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method=random ENV_KWARGS.agent_inferential_mode_fn=1.0 LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="10 jump to 10 at 300 anneal to 1 at 750" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE=1e-5 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE=on PRETRAINED_LISTENERS=agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

# Below are reruns of 2353 (baseline tom) and 2352 (baseline gut) with a smaller listener LR
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - weaker listeners rerun 2353 - cifar10b tom agents pr 1.0 no penalties speaker n search anneal with larger speaker l2 norm term" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn=0.5 ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method=random ENV_KWARGS.agent_inferential_mode_fn=1.0 LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="10 jump to 10 at 300 anneal to 1 at 750" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE=2e-6 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE=on PRETRAINED_LISTENERS=agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R13 - weaker listeners rerun 2352 - cifar10b gut speaker baseline no penalties with larger speaker l2 norm term" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn=0.5 ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method=random ENV_KWARGS.agent_inferential_mode_fn=0.0 LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=1 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE=2e-6 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE=on PRETRAINED_LISTENERS=agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=False

# Below is a run similar to 2353 (baseline tom) but with a sooner and stepwise speaker_n_search. Below that is the same run but with a smaller P_r. Below that is one with a speaker_n_search of 1
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R14b - cifar10b tom agents pr 1.0 no penalties speaker n search stepwise at 200 with new gradients" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="10 jump to 1 at 200" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R14 - cifar10b tom agents pr 0.5 no penalties speaker n search stepwise at 200" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="10 jump to 1 at 200" LISTENER_PR_WEIGHT=0.5 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R14 - cifar10b tom agents pr 1.0 no penalties speaker n search 1" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="1" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R14b - cifar10b tom agents pr 1.0 no penalties speaker n search at 2 with old gradients and softmax beta 10.0" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=4 SPEAKER_ACTION_SELECTION_BETA=10.0


# Below are experimental runs for identifying a signification gap (frozen listeners on first line and learning listeners on second line)
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R15 - cifar10b gut speaker baseline no penalties dead listeners" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="0.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=1 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" LISTENER_TRAIN_SCHEDULE="off" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=False JAX_RANDOM_SEED=$SLURM_ARRAY_TASK_ID
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R15b - cifar10b gut speaker baseline no penalties live listeners" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="0.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=1 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=False JAX_RANDOM_SEED=$SLURM_ARRAY_TASK_ID
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R16d - cifar10b gut speaker baseline no penalties dead listeners harder signaling 0.1 canvas" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="0.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=1 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" LISTENER_TRAIN_SCHEDULE="off" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=False JAX_RANDOM_SEED=$SLURM_ARRAY_TASK_ID

# Below are runs for simple inferential signaling using speaker_n_search of 2 and a softmax speaker action selection
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R17a - cifar10b tom agents pr 1.0 no penalties speaker n search at 2 0.1 canvas" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2 JAX_RANDOM_SEED=$SLURM_ARRAY_TASK_ID
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R15d - cifar10b tom agents pr 1.0 no penalties speaker n search at 2 with ablated Pr" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=0.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2 JAX_RANDOM_SEED=$SLURM_ARRAY_TASK_ID

# Below are runs for inferential signaling agents that become behaviorist over time
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R17b - cifar10b tom to behaviorist at $SLURM_ARRAY_TASK_ID no penalties" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0 jump to 0.0 at $SLURM_ARRAY_TASK_ID" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2 JAX_RANDOM_SEED=53

# Below are runs for inferential signaling with speaker_n_search of 2 and a softmax speaker action selection + env pressure penalties
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R18a - cifar10b tom agents pr 1.0 speaker n search at 2 0.1 canvas curve penalty 0.005" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.005 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2


# Below are experimental runs for more splines
# python3 -u ippo_ff.py WANDB_NOTES="Post-Draft-Part2-R20b - cifar10b tom agents 5 splines 0.1 canvas no penalties" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True ENV_KWARGS.speaker_action_dim=35 MAX_SPEAKER_N_SEARCH=2

# Below are runs that end in ch=1.0 for full symbolification (now with 4 splines)
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R21c - cifar10b tom agents 3 splines 0.3 canvas curve penalty 0.001" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_curve_penalty_coef=0.001 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R21b - cifar10b tom agents 3 splines 0.3 canvas curve penalty -0.01" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_curve_penalty_coef=-0.01 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R22b - cifar10b tom agents 3 splines 0.3 canvas no penalties" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R23a - cifar10b tom agents 3 splines 0.3 canvas whitesum penalty 0.5" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.5 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R23b - cifar10b tom agents 3 splines 0.3 canvas whitesum penalty -0.5" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=-0.5 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R24a - cifar10b tom agents 3 splines 0.3 canvas right angle penalty 0.1" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_right_angle_penalty_coef=0.1 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R24b - cifar10b tom agents 3 splines 0.3 canvas right angle penalty -0.1" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_right_angle_penalty_coef=-0.1 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R25a - cifar10b tom agents 3 splines 0.3 canvas right angle or straight penalty 0.1" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_right_angle_or_straight_penalty_coef=0.1 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R25b - cifar10b tom agents 3 splines 0.3 canvas right angle or straight penalty -0.1" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_right_angle_or_straight_penalty_coef=-0.1 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R26a - cifar10b tom agents 3 splines 0.3 canvas spline similarity penalty 0.3" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_similar_curve_penalty_coef=0.3 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2
# python3 -u ippo_ff.py WANDB_NOTES="XL Post-Draft-Part2-R26b - cifar10b tom agents 3 splines 0.3 canvas spline similarity penalty -0.3" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.5 jump to 1.0 at 1000" ENV_KWARGS.speaker_similar_curve_penalty_coef=-0.3 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH="2" LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-5" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="on" PRETRAINED_LISTENERS="agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb" UPDATE_EPOCHS=6000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True MAX_SPEAKER_N_SEARCH=2



########################################################################
########################################################################
##################### Fall 2025  Starts Below ##########################
########################################################################
########################################################################



#### For collecting listeners to run ToM experiments on cifar20
# python3 -u ippo_ff.py WANDB_NOTES="Fall-2025 cifar20 just listeners punish even less 3.5k epochs" +dataset=cifar20 ENV_KWARGS.channel_ratio_fn="0.0" SPEAKER_TRAIN_SCHEDULE="off" UPDATE_EPOCHS=3500 ENV_NUM_DATAPOINTS=5000 ENV_KWARGS.listener_reward_success=5.0 ENV_KWARGS.listener_reward_failure=-0.01 ENV_KWARGS.channel_ratio_fn=0.0 ENV_KWARGS.speaker_referent_span_fn=20 WANDB_MODE=online PICKLE_FINAL_AGENTS=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar20 just listeners 5k epochs" +dataset=cifar20 ENV_KWARGS.channel_ratio_fn="0.0" SPEAKER_TRAIN_SCHEDULE="off" UPDATE_EPOCHS=5000 ENV_NUM_DATAPOINTS=5000 ENV_KWARGS.listener_reward_success=1.0 ENV_KWARGS.listener_reward_failure=-0.01 WANDB_MODE=online PICKLE_FINAL_AGENTS=True

#### For testing various listener architectures for the phonology study
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv baseline" +dataset=cifar10b LISTENER_ARCH="conv" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv baseline" +dataset=cifar10b LISTENER_ARCH="conv" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener dense" +dataset=cifar10b LISTENER_ARCH="dense" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-bottleneck" +dataset=cifar10b LISTENER_ARCH="conv-bottleneck-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-largekernel" +dataset=cifar10b LISTENER_ARCH="conv-largekernel-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-strided" +dataset=cifar10b LISTENER_ARCH="conv-strided-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-strongembed" +dataset=cifar10b LISTENER_ARCH="conv-strongembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-weakembed" +dataset=cifar10b LISTENER_ARCH="conv-weakembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-high-features" +dataset=cifar10b LISTENER_ARCH="conv-high-features-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-low-features" +dataset=cifar10b LISTENER_ARCH="conv-low-features-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-high-embed" +dataset=cifar10b LISTENER_ARCH="conv-high-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-low-embed" +dataset=cifar10b LISTENER_ARCH="conv-low-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-less-conv" +dataset=cifar10b LISTENER_ARCH="conv-less-conv-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-less-embed" +dataset=cifar10b LISTENER_ARCH="conv-less-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-strongembed" +dataset=cifar10b LISTENER_ARCH="conv-strongembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-weakembed" +dataset=cifar10b LISTENER_ARCH="conv-weakembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True


# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-less-embed" +dataset=cifar10b LISTENER_ARCH="conv-less-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-high-features" +dataset=cifar10b LISTENER_ARCH="conv-high-features-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-low-features" +dataset=cifar10b LISTENER_ARCH="conv-low-features-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-high-embed" +dataset=cifar10b LISTENER_ARCH="conv-high-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-low-embed" +dataset=cifar10b LISTENER_ARCH="conv-low-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-less-conv" +dataset=cifar10b LISTENER_ARCH="conv-less-conv-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-less-embed" +dataset=cifar10b LISTENER_ARCH="conv-less-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-strongembed" +dataset=cifar10b LISTENER_ARCH="conv-strongembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-weakembed" +dataset=cifar10b LISTENER_ARCH="conv-weakembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

# python3 -u ippo_ff.py WANDB_NOTES="cifar10b speaker 2 splines listener conv heatmap test" +dataset=cifar10b LISTENER_ARCH=conv ENV_KWARGS.speaker_action_transform=splines_weight ENV_KWARGS.channel_ratio_fn=0.8 ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method=random ENV_KWARGS.agent_inferential_mode_fn=1.0 LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE=1e-5 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE=on UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True PRETRAINED_LISTENERS=agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb

python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 1 spline listener conv baseline" +dataset=cifar10b LISTENER_ARCH="conv" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=7 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 1 spline listener conv-high-features" +dataset=cifar10b LISTENER_ARCH="conv-high-features-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=7 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 1 spline listener conv-low-features" +dataset=cifar10b LISTENER_ARCH="conv-low-features-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=7 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 1 spline listener conv-high-embed" +dataset=cifar10b LISTENER_ARCH="conv-high-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=7 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 1 spline listener conv-low-embed" +dataset=cifar10b LISTENER_ARCH="conv-low-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=7 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 1 spline listener conv-less-conv" +dataset=cifar10b LISTENER_ARCH="conv-less-conv-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=7 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 1 spline listener conv-less-embed" +dataset=cifar10b LISTENER_ARCH="conv-less-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=7 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 1 spline listener conv-strongembed" +dataset=cifar10b LISTENER_ARCH="conv-strongembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=7 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 1 spline listener conv-weakembed" +dataset=cifar10b LISTENER_ARCH="conv-weakembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=7 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True


## Pre-trained listener agent models below
# for cifar10: "agents-cifar10-peach-spaceship-2253-2000e-5000dp-0fea"
# for cifar10b: "agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb"
# for cifar20: "agents-cifar20-jolly-dawn-2614-3500e-5000dp-5231"
