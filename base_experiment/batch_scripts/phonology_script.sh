#!/bin/bash

#SBATCH -J siggame
#SBATCH -N 1
#SBATCH -c 4
#SBATCH --ntasks=1
#SBATCH --ntasks-per-node=1
#SBATCH --time=9:00:00
#SBATCH --mem=12GB
#SBATCH --partition=3090-gcondo
#SBATCH --gres=gpu:1
#SBATCH -C geforce3090

#SBATCH --array=1-1
#SBATCH -o job_outputs_ph/siggame_ph_job_%j.o
#SBATCH -e job_outputs_ph/siggame_ph_job_%j.e
#SBATCH --mail-type=END
#SBATCH --mail-user=benjamin_spiegel@brown.edu

echo $LD_LIBRARY_PATH
unset LD_LIBRARY_PATH
echo $LD_LIBRARY_PATH

export HYDRA_FULL_ERROR=1
# export JAX_DEBUG_NANS=True
# export NVIDIA_TF32_OVERRIDE=0

export WANDB_DIR=/oscar/data/gdk/bspiegel/signification-game-wandb/

source /oscar/home/bspiegel/envs/jax.venv/bin/activate
cd /oscar/home/bspiegel/signification-game/base_experiment/


########################################################################
########################################################################
##################### Fall 2025  Starts Below ##########################
########################################################################
########################################################################



#### For collecting listeners to run ToM experiments on cifar20
# python3 -u ippo_ff.py WANDB_NOTES="Fall-2025 cifar20 just listeners punish even less 3.5k epochs" +dataset=cifar20 ENV_KWARGS.channel_ratio_fn="0.0" SPEAKER_TRAIN_SCHEDULE="off" UPDATE_EPOCHS=3500 ENV_NUM_DATAPOINTS=5000 ENV_KWARGS.listener_reward_success=5.0 ENV_KWARGS.listener_reward_failure=-0.01 ENV_KWARGS.channel_ratio_fn=0.0 ENV_KWARGS.speaker_referent_span_fn=20 WANDB_MODE=online PICKLE_FINAL_AGENTS=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar20 just listeners 5k epochs" +dataset=cifar20 ENV_KWARGS.channel_ratio_fn="0.0" SPEAKER_TRAIN_SCHEDULE="off" UPDATE_EPOCHS=5000 ENV_NUM_DATAPOINTS=5000 ENV_KWARGS.listener_reward_success=1.0 ENV_KWARGS.listener_reward_failure=-0.01 WANDB_MODE=online PICKLE_FINAL_AGENTS=True

#### For testing various listener architectures for the phonology study
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv baseline" +dataset=cifar10b LISTENER_ARCH="conv" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv baseline" +dataset=cifar10b LISTENER_ARCH="conv" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener dense" +dataset=cifar10b LISTENER_ARCH="dense" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-bottleneck" +dataset=cifar10b LISTENER_ARCH="conv-bottleneck-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-largekernel" +dataset=cifar10b LISTENER_ARCH="conv-largekernel-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-strided" +dataset=cifar10b LISTENER_ARCH="conv-strided-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-strongembed" +dataset=cifar10b LISTENER_ARCH="conv-strongembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-weakembed" +dataset=cifar10b LISTENER_ARCH="conv-weakembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-high-features" +dataset=cifar10b LISTENER_ARCH="conv-high-features-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-low-features" +dataset=cifar10b LISTENER_ARCH="conv-low-features-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-high-embed" +dataset=cifar10b LISTENER_ARCH="conv-high-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-low-embed" +dataset=cifar10b LISTENER_ARCH="conv-low-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-less-conv" +dataset=cifar10b LISTENER_ARCH="conv-less-conv-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-less-embed" +dataset=cifar10b LISTENER_ARCH="conv-less-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-strongembed" +dataset=cifar10b LISTENER_ARCH="conv-strongembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-weakembed" +dataset=cifar10b LISTENER_ARCH="conv-weakembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True


# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep listener conv-less-embed" +dataset=cifar10b LISTENER_ARCH="conv-less-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-high-features" +dataset=cifar10b LISTENER_ARCH="conv-high-features-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-low-features" +dataset=cifar10b LISTENER_ARCH="conv-low-features-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-high-embed" +dataset=cifar10b LISTENER_ARCH="conv-high-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-low-embed" +dataset=cifar10b LISTENER_ARCH="conv-low-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-less-conv" +dataset=cifar10b LISTENER_ARCH="conv-less-conv-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-less-embed" +dataset=cifar10b LISTENER_ARCH="conv-less-embed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-strongembed" +dataset=cifar10b LISTENER_ARCH="conv-strongembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b phonology sweep 2 splines listener conv-weakembed" +dataset=cifar10b LISTENER_ARCH="conv-weakembed-1" ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 2000" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method="random" ENV_KWARGS.agent_inferential_mode_fn="1.0" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 5e-6 at 2000" SPEAKER_LR_SCHEDULE="1e-4" SPEAKER_TRAIN_SCHEDULE="off then on at 2000" UPDATE_EPOCHS=4000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True

# python3 -u ippo_ff.py WANDB_NOTES="cifar10b speaker 2 splines listener conv heatmap test ch 1" +dataset=cifar10b LISTENER_ARCH=conv ENV_KWARGS.speaker_action_transform=splines_weight ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_curve_penalty_coef=0.0 ENV_KWARGS.speaker_whitesum_penalty_coef=0.0 ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.speaker_assignment_method=random ENV_KWARGS.agent_inferential_mode_fn=1.0 LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 L2_REG_COEF_SPEAKER=1e-2 LISTENER_LR_SCHEDULE=1e-5 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE=on UPDATE_EPOCHS=2000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True PRETRAINED_LISTENERS=agents-cifar10b-woven-glade-2275-2000e-5000dp-c6fb

########################################################################
################### Full Phonology Sweep Below #########################
########################################################################


#### Listener Pretraining ####

# PARAMS=$(sed -n "$((SLURM_ARRAY_TASK_ID))p" batch_scripts/sweep_params/sweep_phones_listener_pretrain_25.txt)
# PARAMS=$(sed -n "$((SLURM_ARRAY_TASK_ID))p" batch_scripts/sweep_params/sweep_phones_listener_pretrain_50.txt)
# echo $PARAMS
# There are 7 of these

# ## cifar10b, 1000 epoch just pretraining to save (these have different pre-training parameters than those above)
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b 1000 epoch just pretraining" PROJECT="phonology-study" +dataset=cifar10b NUM_STEPS=2048 ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 1000" ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.agent_inferential_mode_fn="gut" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE=1e-4 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 1000" UPDATE_EPOCHS=1000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=True LOG_TOM_SPEAKER_EXAMPLES=True PRETRAINED_LISTENERS="" $PARAMS

## cifar10b, 250 epoch just pretraining to save
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b 250 epoch just pretraining" PROJECT="phonology-study" +dataset=cifar10b NUM_STEPS=2048 ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.agent_inferential_mode_fn="gut" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE=1e-4 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=250 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=True LOG_TOM_SPEAKER_EXAMPLES=True PRETRAINED_LISTENERS="" $PARAMS


#### Full Sweep ####

# PARAMS=$(sed -n "$((SLURM_ARRAY_TASK_ID))p" batch_scripts/sweep_params/sweep_phones_no_pretraining_params_25.txt)
# PARAMS=$(sed -n "$((SLURM_ARRAY_TASK_ID))p" batch_scripts/sweep_params/sweep_phones_no_pretraining_params_50.txt)
# PARAMS=$(sed -n "$((SLURM_ARRAY_TASK_ID))p" batch_scripts/sweep_params/sweep_phones_params_pretrained_25_250_epochs.txt)
# PARAMS=$(sed -n "$((SLURM_ARRAY_TASK_ID))p" batch_scripts/sweep_params/sweep_phones_params_pretrained_25_1000_epochs.txt)
# PARAMS=$(sed -n "$((SLURM_ARRAY_TASK_ID))p" batch_scripts/sweep_params/sweep_phones_params_pretrained_50_250_epochs.txt)
# PARAMS=$(sed -n "$((SLURM_ARRAY_TASK_ID))p" batch_scripts/sweep_params/sweep_phones_params_pretrained_50_1000_epochs.txt)
# echo $PARAMS
# There are 35 of these


## cifar10b, 2 splines
# python3 -u ippo_ff.py WANDB_NOTES="phonology sweep cifar10b 2 splines thick gut" PROJECT="phonology-study" WANDB_TAGS="[main, 250e25a2sT]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.agent_inferential_mode_fn="gut" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE=1e-5 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE=on UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True $PARAMS

# cifar10b, 3 splines
# python3 -u ippo_ff.py WANDB_NOTES="phonology sweep cifar10b 3 splines" PROJECT="phonology-study" WANDB_TAGS="[main, 250e25a3s]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE=1e-5 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE=on UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True $PARAMS


#### Micro Listener Arch Sweeps ####

# cifar10b, 3 splines, including pretraining. For finding an appropriate listener learning rate and l2 reg coef
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro" PROJECT="phonology-study" WANDB_TAGS="[micro]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE=1e-5 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-B-0" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 250"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro" PROJECT="phonology-study" WANDB_TAGS="[micro]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE=1e-5 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-B-0" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-3 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 250"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro" PROJECT="phonology-study" WANDB_TAGS="[micro]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE=1e-5 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-B-0" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE=1e-4
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro" PROJECT="phonology-study" WANDB_TAGS="[micro]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE=1e-5 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-B-0" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-3 LISTENER_LR_SCHEDULE=1e-4


# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro no pretraining" PROJECT="phonology-study" WANDB_TAGS="[micro, gut]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn=1.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="gut" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-C-0" SPEAKER_ARCH="splines" LISTENER_LR_SCHEDULE=1e-4
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro no pretraining" PROJECT="phonology-study" WANDB_TAGS="[micro, gut]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn=1.0 ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="gut" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-C-0" SPEAKER_ARCH="splines" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 250"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro no pretraining" PROJECT="phonology-study" WANDB_TAGS="[micro, gut]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 100" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="gut" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 100" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-C-1" SPEAKER_ARCH="splines" LISTENER_LR_SCHEDULE=1e-4
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro no pretraining" PROJECT="phonology-study" WANDB_TAGS="[micro, gut]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 100" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="gut" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 100" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-C-1" SPEAKER_ARCH="splines" LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 100"


## Level runs
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro A" PROJECT="phonology-study" WANDB_TAGS="[micro, microA, level]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-A-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 3e-5 at 250"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro B" PROJECT="phonology-study" WANDB_TAGS="[micro, microB, level]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-B-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro C" PROJECT="phonology-study" WANDB_TAGS="[micro, microC, level]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-C-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 3e-5 at 250"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micro C" PROJECT="phonology-study" WANDB_TAGS="[micro, microC, level]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micro-C-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"


## MLP feature and layer runs

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micromlp" PROJECT="phonology-study" WANDB_TAGS="[micromlp, feature]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micromlp-base" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micromlp" PROJECT="phonology-study" WANDB_TAGS="[micromlp, feature]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micromlp-base" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micromlp feature" PROJECT="phonology-study" WANDB_TAGS="[micromlp, feature]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micromlp-F$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micromlp feature" PROJECT="phonology-study" WANDB_TAGS="[micromlp, feature]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micromlp-F$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micromlp layer" PROJECT="phonology-study" WANDB_TAGS="[micromlp, LLlayer]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micromlp-LL$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines micromlp layer" PROJECT="phonology-study" WANDB_TAGS="[micromlp, LLlayer]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-micromlp-LL$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines conv layers" PROJECT="phonology-study" WANDB_TAGS="[convlayers, convA]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-conv-A-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines conv layers" PROJECT="phonology-study" WANDB_TAGS="[convlayers, convA]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-conv-A-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250"

#### Skip Pool Litener Arch Sweeps ####

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines skippool no pretraining" PROJECT="phonology-study" WANDB_TAGS="[skippool]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 100" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 100" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-skippool-0" SPEAKER_ARCH="splines" LISTENER_LR_SCHEDULE=1e-4
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines skippool small pretraining slow learning" PROJECT="phonology-study" WANDB_TAGS="[skippool]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 100" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-skippool-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-3 LISTENER_LR_SCHEDULE="1e-5"

#### Original archs sweeps, over pretraining epochs

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[conv, epochsweep]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 500" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 500" UPDATE_EPOCHS=3250 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[conv, epochsweep]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 500" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 500" UPDATE_EPOCHS=3250 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 500"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[conv, epochsweep]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 750" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 750" UPDATE_EPOCHS=3500 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[conv, epochsweep]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 750" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 750" UPDATE_EPOCHS=3500 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 750"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[conv, epochsweep]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 1000" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 1000" UPDATE_EPOCHS=3750 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[conv, epochsweep]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 1000" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 1000" UPDATE_EPOCHS=3750 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 1000"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[conv, epochsweep]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 1500" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 1500" UPDATE_EPOCHS=4250 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[conv, epochsweep]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 1500" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 1500" UPDATE_EPOCHS=4250 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 1500"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines basic conv arch" PROJECT="phonology-study" WANDB_TAGS="[]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 0.8 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250"


#### Single layer conv arch sweep

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines 1conv" PROJECT="phonology-study" WANDB_TAGS="[1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-1conv-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines 1conv" PROJECT="phonology-study" WANDB_TAGS="[1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="conv-ablate-1conv-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4"

#### Dense listener arch sweep

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines dense" PROJECT="phonology-study" WANDB_TAGS="[dense, lowLR]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="dense-ablate-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5 jump to 4e-6 at 250"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines dense" PROJECT="phonology-study" WANDB_TAGS="[dense, lowLR]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="dense-ablate-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines dense" PROJECT="phonology-study" WANDB_TAGS="[dense, lowLR]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 750" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 750" UPDATE_EPOCHS=3500 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="dense-ablate-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5 jump to 4e-6 at 750"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines dense" PROJECT="phonology-study" WANDB_TAGS="[dense, lowLR]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 750" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 750" UPDATE_EPOCHS=3500 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="dense-ablate-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5"

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines dense" PROJECT="phonology-study" WANDB_TAGS="[dense]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 500" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 500" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="dense-ablate-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=5e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-4 at 500 anneal to 1e-5 at 2000"
# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines dense" PROJECT="phonology-study" WANDB_TAGS="[dense]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 1000" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 1000" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True LISTENER_ARCH="dense-ablate-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=5e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-4 at 1000 anneal to 1e-5 at 2000"

############## Back to Basics ###############

# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines conv" PROJECT="phonology-study" WANDB_TAGS="['listener search', 250e25a3s]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-25-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.2 SPEAKER_STDDEV=1.0
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines micro-C" PROJECT="phonology-study" WANDB_TAGS="['listener search', microC]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-micro-C-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.2 SPEAKER_STDDEV=1.0
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines micro-A" PROJECT="phonology-study" WANDB_TAGS="['listener search', microA]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-micro-A-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-3 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.2 SPEAKER_STDDEV=1.0
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines micro-B" PROJECT="phonology-study" WANDB_TAGS="['listener search', microB]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-micro-B-$((SLURM_ARRAY_TASK_ID))" SPEAKER_ARCH="splines" L2_REG_COEF_LISTENER=1e-3 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.2 SPEAKER_STDDEV=1.0


########################################################################
####################   Speaker Stuff Below    ##########################
########################################################################

## cifar10b, 250 epoch just pretraining to save
# python3 -u ippo_ff.py WANDB_NOTES="cifar10b 250 epoch just pretraining quantized" PROJECT="phonology-study" WANDB_TAGS="[quantized, pretraining]" +dataset=cifar10b NUM_STEPS=2048 ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=14 ENV_KWARGS.agent_inferential_mode_fn="gut" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE=1e-4 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=250 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=True LOG_TOM_SPEAKER_EXAMPLES=True PRETRAINED_LISTENERS="" LISTENER_ARCH="conv-quantize-test1"


#### Speaker arch sweep ####

# python3 -u ippo_ff.py WANDB_NOTES="phonology cifar10b 3 splines 25" PROJECT="phonology-study" WANDB_TAGS="[250e25a3s]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 LISTENER_LR_SCHEDULE=1e-5 SPEAKER_LR_SCHEDULE=1e-4 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online PICKLE_FINAL_AGENTS=False LOG_TOM_SPEAKER_EXAMPLES=True SPEAKER_ARCH="splines-ablate-25-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-3 LISTENER_LR_SCHEDULE="1e-4 jump to 1e-5 at 250"

## Listener conv layer save for sweep
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker" PROJECT="phonology-study" WANDB_TAGS="[rnn, 1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=250 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-rnn-quantized-A9-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 PICKLE_FINAL_AGENTS=True


# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines 1conv micro speaker" PROJECT="phonology-study" WANDB_TAGS="[speakermicro, 1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-ablate-micro-A-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines dense micro speaker" PROJECT="phonology-study" WANDB_TAGS="[speakermicro, dense]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="dense-ablate-7" SPEAKER_ARCH="splines-ablate-micro-A-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=5e-2 LISTENER_LR_SCHEDULE="4e-5 jump to 1e-5 at 250" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5

# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker quantized" PROJECT="phonology-study" WANDB_TAGS="[speakermicro, 1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-ablate-micro-A-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.3 SPEAKER_STDDEV=1.0 PRETRAINED_LISTENERS=agents-cifar10b-fine-snow-668-250e-5000dp-9ed3

## Quantized
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker" PROJECT="phonology-study" WANDB_TAGS="[rnn, 'speaker search']" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="0.0 jump to 1.0 at 250" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="off then on at 250" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-rnn-quantized-A9-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="1e-4 jump to 2e-5 at 250" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.3 SPEAKER_STDDEV=1.0

## Sweep over weight initializations and rnn archs without quantization
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker" PROJECT="phonology-study" WANDB_TAGS="[rnn, 1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-rnn-quantized-B-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.2 SPEAKER_STDDEV=1.0 PRETRAINED_LISTENERS=agents-cifar10b-fine-snow-668-250e-5000dp-9ed3
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker" PROJECT="phonology-study" WANDB_TAGS="[rnn, 1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-rnn-quantized-B-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.3 SPEAKER_STDDEV=0.7 PRETRAINED_LISTENERS=agents-cifar10b-fine-snow-668-250e-5000dp-9ed3
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker" PROJECT="phonology-study" WANDB_TAGS="[rnn, 1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-rnn-quantized-B-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.2 SPEAKER_STDDEV=0.7 PRETRAINED_LISTENERS=agents-cifar10b-fine-snow-668-250e-5000dp-9ed3


## Sweep over weight initializations and rnn archs *with* quantization
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker quantized" PROJECT="phonology-study" WANDB_TAGS="[rnn_quantized, 1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-rnn-quantized-B-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.3 SPEAKER_STDDEV=1.0 PRETRAINED_LISTENERS=agents-cifar10b-fine-snow-668-250e-5000dp-9ed3
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker quantized" PROJECT="phonology-study" WANDB_TAGS="[rnn_quantized, 1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-rnn-quantized-C-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.3 SPEAKER_STDDEV=0.7 PRETRAINED_LISTENERS=agents-cifar10b-fine-snow-668-250e-5000dp-9ed3


## Not using these parameters anymore
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker quantized" PROJECT="phonology-study" WANDB_TAGS="[rnn_quantized, 1conv]" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-rnn-quantized-C-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.2 SPEAKER_STDDEV=0.7 PRETRAINED_LISTENERS=agents-cifar10b-fine-snow-668-250e-5000dp-9ed3

############## Back to Basics ###############

python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker" PROJECT="phonology-study" WANDB_TAGS="[rnn, 'speaker search']" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-rnn-quantized-A0P-$((SLURM_ARRAY_TASK_ID))" L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.3 SPEAKER_STDDEV=1.0 PRETRAINED_LISTENERS=agents-cifar10b-fine-snow-668-250e-5000dp-9ed3
# python3 -u ippo_ff.py WANDB_NOTES="phonology-speaker cifar10b 3 splines rnn speaker quantized" PROJECT="phonology-study" WANDB_TAGS="[rnn_quantized, 'speaker search']" +dataset=cifar10b ENV_KWARGS.channel_ratio_fn="1.0" ENV_KWARGS.speaker_action_dim=21 ENV_KWARGS.agent_inferential_mode_fn="tom" LISTENER_N_SAMPLES=6 SPEAKER_N_SEARCH=2 MAX_SPEAKER_N_SEARCH=2 LISTENER_PR_WEIGHT=1.0 SPEAKER_TRAIN_SCHEDULE="on" UPDATE_EPOCHS=3000 ENV_NUM_DATAPOINTS=5000 WANDB_MODE=online LISTENER_ARCH="conv-ablate-1conv-1" SPEAKER_ARCH="splines-rnn-quantized-A3Q-$((SLURM_ARRAY_TASK_ID))" VQ_COEF_SPEAKER=0.5 L2_REG_COEF_LISTENER=1e-2 LISTENER_LR_SCHEDULE="2e-5" L2_REG_COEF_SPEAKER=1e-2 SPEAKER_LR_SCHEDULE=5e-5 SPEAKER_SQUISH=0.3 SPEAKER_STDDEV=1.0 PRETRAINED_LISTENERS=agents-cifar10b-fine-snow-668-250e-5000dp-9ed3
